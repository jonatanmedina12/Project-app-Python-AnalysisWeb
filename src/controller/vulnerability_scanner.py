import requests


class VulnerabilityScanner:
    def __init__(self):
        self.headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.3'
        }

    def search_cves(self, service):
        url = f"https://services.nvd.nist.gov/rest/json/cves/2.0?KeywordSearch={service}"

        response = requests.get(url, headers=self.headers)

        if response.status_code != 200:
            return "no se pudo obtener informaci√≥n de las vulnerabilidades"

        data_dict = response.json()
        cves_info = []

        for vulnerability in data_dict.get('vulnerabilities', []):
            cve = vulnerability.get('cve', {})
            cve_id = cve.get('id')
            descriptions = cve.get('descriptions', [])
            description = next((desc['value'] for desc in descriptions if desc.get('lang') == 'en'),
                               None)  # Changed 'es' to 'en' as English is more commonly available

            if cve_id and description:
                cves_info.append({
                    'cve_id': cve_id,
                    'description': description
                })

        return cves_info